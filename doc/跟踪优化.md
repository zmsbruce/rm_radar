# 跟踪优化

*2024/4/13 by zmsbruce*

## 为什么要优化

当检测框包含场地边缘时，定位会受到噪点的干扰而导致定位结果不准确（具体可以查看[此文档](./聚类优化.md)）。我们借用 SORT 的思想，构造出针对一套针对三维坐标的跟踪算法。

## 滤波器的选择

使用辛格模型（Singer model）作为滤波器。辛格模型通过引入一个随机过程来模拟加速度变化，适用于处理加速度不是恒定的、具有机动性的目标。并且辛格模型参数少，只需要调整两个参数。

## 匹配算法

匹配算法使用 Auction 算法。算法以其竞拍（或拍卖）的过程命名，其中买家（或对象）和卖家（或任务）通过一系列迭代竞标来达到最优匹配。算法简单直观，且易于实现。

## 整体算法

整体算法与 SORT 近似：

1. **检测**：在每一帧中，首先检测出每个机器人的三维位置坐标和类别；

2. **预测**：对于已经在跟踪中的每个目标，使用卡尔曼滤波器预测其在当前帧中的位置；

3. **数据关联**：使用当前帧中的检测结果和预测的跟踪位置来进行数据关联。关联评分通过计算位置和类别按照一定比例加权得到。

4. **更新**：根据匹配结果，更新每个跟踪目标的状态。如果一个跟踪目标在当前帧有匹配的检测结果，则卡尔曼滤波器使用这个新的检测数据来校正目标的位置和类别。

5. **创建和删除轨迹**：对于那些在当前帧中被检测到但没有与任何现有跟踪匹配的检测框，初始化新的跟踪器。如果一个跟踪目标在多个连续帧中没有匹配的检测结果，认为该目标已经丢失，因此将其从跟踪列表中删除。

## 可优化的地方

- 当前滤波器的输入为 x, y, z 三维坐标，后续可以**添加长宽高**等输入（因为当存在场地边缘的噪声时，长宽高的最值之比会比较大，可以反过来进行判断），可能使得跟踪结果更加准确。